\documentclass[letterpaper,12pt]{article}
\usepackage{tabularx} % extra features for tabular environment
\usepackage{amsmath}  % improve math presentation
\usepackage{amsfonts}
\usepackage{verbatim}
\usepackage{graphicx} % takes care of graphic including machinery
\usepackage[margin=1in,letterpaper]{geometry} % decreases margins
\usepackage{cite} % takes care of citations
\usepackage[final]{hyperref} % adds hyper links inside the generated pdf file

\usepackage{booktabs}

\hypersetup{
	colorlinks=true,       % false: boxed links; true: colored links
	linkcolor=blue,        % color of internal links
	citecolor=blue,        % color of links to bibliography
	filecolor=magenta,     % color of file links
	urlcolor=blue         
}
\usepackage{blindtext}

\usepackage{units}
\usepackage{lineno}
\usepackage{comment}
\usepackage{float}
%++++++++++++++++++++++++++++++++++++++++


\begin{document}
\linenumbers
\title{Uncertainty Quantification in Multiscale Model }
\author{authors}
\date{\today}
\maketitle
\begin{abstract}
    This work quantifies uncertainties in a multiscale model for charge dynamics in organic semiconductors (OSCs). A first-principle multiscale model integrates classical molecular dynamics (MD), density functional theory (DFT), and continuous-time random walk (CTRW) processes to allow the simulation of charge transport in OSCs. The model brings inherent uncertainties arising from the empirical approximations and numerical simulations. Our work particularly focusing on quantifying the uncertainty in DFT exchange-correlation functional.

    By investigating the effects of varying Hartree-Fock (HF) levels within DFT functionals, we analyze the impact on electronic structures such as reorganization energy, molecule energy distribution, and coupling elements. The primary goal is to assess the robustness of predicting the quantity of interest (QoI), that is time-of-flight and charge mobility, under these uncertainties.
    
    Monte Carlo simulations and sensitivity analysis are employed to estimate the range and confidence levels of the predicted charge mobility. As shown by Sobol indices, the QoI is most sensitive to molecule energy, then reorganization energy and least sensitive to coupling elements.  
\end{abstract}

\section{Background}

Theoretical model and computer simulation for understanding a physical system usually contain some uncertainties in predicting the system features. 
For example, the theoretical model does not encompass all relevant physical factors, the theoretical model incorporates empirical parameters that include noise, the numerical scheme contains approximation, the simulation use noisy quantities, etc.
Nevertheless, those uncertainties should not affect the validity of the model or the accuracy for the predicting system in terms of some quantities of interest (QoI). 
Here the terminology "uncertainties" refers to the impossibility of getting a deterministic QoI, and excludes theoretical or numerical errors. 
The amount of uncertainty in the QoI plays an important role in determining the usefulness of the model. 
So quantifying the uncertainty is a key factor for telling if the model is quanlitatively or quantitatively accurate. 

In this work, an investigated model containing uncertainties is the multiscale model of charge dynamics in organic semiconductors (OSCs), which are materials that consist of organic molecules with disordered and amorphous structure. Besides its semiconducting properties, tthey are mechanically flexible and comes with controllable charge transport properties. 
This flexible functionality is achieved by tuning molecular properties to achieve an ideal operating properties at the device-level, so a fundamental understanding of OSC from molecule scale  plays an important role in OSC optimization.
Conducting these optimization processes through experimental methods is financially demanding. In contrast, computational approaches such as the multiscale model provides insightful guidance for such investigation. So robustness of the computational model is paramount to promote OSC optimization.

Like every other models, the multiscale model contains uncertainties due to certain approximation in modeling perspective, the randomness nature of the physical quantities, and the limitation of the numerical simulations, only to name a few.
To explain in detail those uncertainties, the first-principle multiscale model is briefly reviewed. 

Fundamentally, quantum-mechanical description is needed to model charge dynamics due to the motion of electrons. However, the resulting full many-electron schr\"{o}dinger equation is impossible to solve due to its complexity, so Density Functional Theory (DFT) appears as a manageable way to model electrons.
DFT has its own challenges in achieving multiscale modeling.
The first challenge relates to the Born-Oppenheimer approximation in quantum
mechanics, which simplifies the problem by separating the electronic and nuclear
coordinates. As a result, the time evolution of the atomic coordinates can be modeled in molecular dynamics (MD) by solving the Newton's equation using empirical force field to approximate the potential energy surfaces (need citation). 

The next challenge is the infeasibility of solving the DFT equations for the entire system even at a fixed time. 
But due to fact that OSCs have disordered and amorphous structure and the quantum states of each molecule is confined to a limited region, the charge dynamic can be well-approxmiated as a jumping process between molecules, which is a continuous time random walk (CTRW) process.
The transition rates between the molecules can be calculated from quantum chemical calculations and related to the electronic structures parameters including the molecule energy, reorganization energy and coupling elements which will be explained in the methodology section. 

Until this point, the molecular system is modeled as graph $\mathbf{G}(\mathbf{V}, \mathbf{W})$ where $\mathbf{V}$ is the set of nodes and $\mathbf{W}: \omega_{ij}$ is the adjacency matrix. Each node represents one molecule, the weighted and directed edge $\omega_{ij}$ represents the transition rates from node $i$ to node $j$ calculated from quantum chemical methods. 
As will be shown in the method section, $\omega_{ij}$ determines the QoIs whose quantities we want to quantify.

Figure \ref{fig:MSM} summarized the multiscale model as mentioned above using MADN, a type of OSC as an example. 
The process includes: Firstly, classical Molecular Dynamics is used to generate the atomistic coordinates of all molecules. Then DFT is used to obtain electronic structures. Finally the charge dynamic is model as a CTRW among the molecules.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.99\textwidth]{figs/MSM.pdf}
    \caption{The multiscale model workflow for OSC. Step 1: MD simulation to generate atom coordinates. Step 2: Molecule energy $E_i$ calculation. Step 3: Calculation of Reorganization energy $\lambda_{ij}$ and coupling element $J_{ij}$ for pairs of molecule $i,j$ whose COM distance is less than $r_\text{cutoff}$. Step 4: Modelling dynamics on device level, such as ToF calculation.}
    \label{fig:MSM}
\end{figure}

In achieving the multiscale model, uncertainties are introduced. 
While Born-Oppenheimer approximation allows for the use of force field to approximate the potential energy surfaces (need citation) and model the atomic coordinates using Newtonâ€™s equations, the force field is not exactly the same as the potential for DFT. 
So the atomic coordinates, that is the molecule structures contain uncertainty which ultimately affects the charge dynamics. 
This is one source of uncertainty that have not been investigated. But in our investigation, a fixed molecule structure is used and we do not consider this source of uncertainty. 
Secondly, charge jumping between the state localization is not exactly a time dependent DFT process. 
However, the amorphous OSCs used in this work has strong disorder, so the model noise from state localization is negligible and we do not consider the uncertainty originated from this perspective.
Lastly, the source of uncertain that this work focus on comes from the approximation for the exchange-correlation energy in DFT. 
There is no exact formula for the exchange-correlation functional, so in practical approximations are developed and tested to guarantee the robustness of DFT method. 
The accuracy of DFT depends heavily on the choice of the exchange-correlation functional whose suitability is usually unknown for new synthesized molecules. 
As an advancement to improve accuracy, Hybrid-DFT incorporates a portion $\alpha$ of exact HF exchange functional (HFX) from Hartree-Fock (HF) theory into the exchange-correlation functional, particularly for systems where DFT falls short. For example, the PBE0 functional has a portion of 0.25 HFX.

Looking back into the CTRW of the charge transport, the transition rates depend on the electronic structures parameters which rely on the validity of the exchange-correlation functional from the modeling perspectives.
So the approximations in exchange-correlation functional will bring uncertainties to the multiscale model. 
In particular, different hybrid-DFT functionals containing varying HFX levels will generate different output from the multiscale model mentioned aboved. 
The effect of such uncertainty from the electronic structure level on the multiscale model is not yet explored in literatures. 
The goal of this work is to quantify the uncertainty effect of the exchange-correlation functional on the charge dynamics in OSCs and to study the robustness of the multiscale model, with a particular focus on the uncertainty represented by different portional of HFX.

A QoI need be chosen to perform this goal of uncertainty quantification. 
The figure of merit in OSC investigation is the charge mobility, which quantitatively describe how fast charges move in an OSC. 
The charge mobility is commonly measured in a \textit{time-of-flight} (ToF) setting. 
As shown in Fig.\ref{fig:MSM}(d), charge carriers are injected into one electrode called \textit{Source} and they are collected by another electrode at the opposite end called \textit{Sink}. 
Knowing the length of the sample $L$ and the time-of-flight $\tau$, the diffusive velocity is calculated as $v_\text{ToF}=\frac{L}{\tau}$.
When electric field $\vec{F}$ is used and the charge dynamics undergo a field-drifted transport, the charge mobility is calculated as $\mu_\text{ToF}=\frac{\vec{v}_\text{ToF} \vec{F}}{|\vec{F}|^2}$. 

Some literatures also report a steady state setting for investigation of charge mobility. In such condition, there is no \textit{Source}-\textit{Sink} boundary condition. Instead, the molecular system is infinitely repeated in all three dimensions by periodic boundary conditions. 
Over a long time period, the charge occupation on each molecule $\pi_i$ reach an equilibrium, allowing a steady state distribution to be obtained.
The steady state charge velocity $v_\text{SS}$ is calculated as the charge velocity along the direction of the electric field normalized by the steady state charge occupation $\vec{\pi}:\pi_i$. 
The calculation for $v_\text{ToF}$ and $\mu_\text{SS}$ will be detailed in the method section.

To quantify the uncertainty for QoI, the focus of our work will be placed on answering the following questions: 
\begin{enumerate}
    \item How does HFX level change the electronic structures: reorganization energy, distribution of molecule energies and coupling elements? 
    \item How does HFX level change the charge mobility?
    \item Which electronic structure (among energy, coupling element and reorganization energy) uncertainty has the most impact on the QoI distribution?
    \item Can we estimate the range of the QoI, given a confidence level?
\end{enumerate}

The rest of the paper is organized as follows. Section 2 will outline the multiscale model in OSCs. This includes the electronic structure calculation centering on Kohn-Sham equation, the calucation of molecule energy, reorganization energy and coupling elements. The details of the molecule dynamics to obtain the MADN system will be listed.
Then section 3 present the multiscale modeling results with the chose HFX values. In section 4, the Monte Carlo sampling method is utilized to estimate the ToF distribution and $v_\text{SS}$ distribution, followed by the sensitivity analysis on the parameters. 
Section 5 shows calculated Poole-Frankel behavior of the MADN with varying HFX values. The confidence interval of the Poole-Frankel plot is estimated. Section 6 concludes the paper. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Multiscale Model}
As mentioned in the introduction, the multiscale model maps a structural morphology into graph $\mathbf{G}(\mathbf{V}, \mathbf{W})$. In our context, the graph properties, that is the entries in $\mathbf{W}$, depends on the HFX values. 

{\Huge Here}

When there is one charge carrier, each state in CTRW corresponds to the charge occupation in each molecule. The transition rates between the state, that is the rate for charge transfer rates between two molecules $i$ and $j$ is calculated as the Marcus rate:
%
\begin{equation}
    \omega_{ij} = \frac{2\pi}{\hbar} \frac{|J_{ij}|^2}{\sqrt{4\pi \lambda_{ij} k_\text{B}T}} \exp\left(-\frac{(E_{ij} + q \vec{F} \cdot \vec{r}_{ij} - \lambda_{ij})^2}{4\lambda_{ij} k_\text{B}T}\right) ,
    \label{equ:Marcus}
\end{equation}
%
where $\hbar$ is the reduced Planck constant and $k_\text{B}$ the Boltzmann constant. The temperature $T$ (in \unit[]{K}), the charge of the carrier $q$ (in \unit[]{e}) and the external electric field $\vec{F}$ (in V/m) can be considered the external, environmental parameters of the simulation. The vector $\vec{r}_{ij} = (r^x_{ij},r^y_{ij},r^z_{ij})^\text{T}$ connects the center-of-masses (COMs) of molecules $i$ and $j$, which is calculated cyclic boundary conditions depending on the boundary condition. The remaining physical, material-specific (or rather transfer-pair-specific) quantities are the reorganization energy $\lambda_{ij}$, the electronic coupling $J_{ij}$, and the energy difference $E_{ij} = E_i - E_j$ (all in \unit[]{eV}). With the information about the molecular COMs and the rates, one can construct the graph $\mathbf{G}=(\mathbf{V}, \mathbf{W})$ on which the CTRW takes place. $\mathbf{V}$ is a set of nodes (molecules) and $\mathbf{W}: \omega_{ij}$ is the adjacency matrix. A rate is only considered between molecules $i$ and $j$ if their closest-contact distance is smaller than $r_\text{cutoff}=\unit[0.5]{nm}$.

In the section, the components of the multiscale model will be introduced: molecule dynamics, calculation of reorganization energy, molecule energy, coupling element, $v_\text{SS}$ and $v_\text{ToF}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Molecule Dynamics Simulation}
\begin{comment}
    The MD in the multiscale model is to use Newton's second law to update the atomic coordinate. Written in Hamilton equation, the equation of motion reads:
\begin{equation}
    \begin{cases}
        \frac{d \vec{r}_i}{dt} = \frac{\partial H^\text{MD} }{\partial \vec{p}_i} \\
        \frac{d \vec{p}_i}{dt} = -\frac{\partial H^\text{MD} }{\partial \vec{r}_i}
    \end{cases}
    \label{eq:Hamilton}
\end{equation}
for $i=1,\cdots,N_a$. Where $N_a$, $m_i$, $\vec{r}_i$, $\vec{p}_i$ are the atom number, atomic mass,  position vector and momentum, respectively. 
And the Hamiltonian $H$ reads:
$H^\text{MD}=\sum\limits_{i} \frac{|\vec{p}_i|^2}{2 m_i} + U(\vec{r}_1,\cdots,\vec{r}_{N_a})$.

In principle the potential energy function $U(\vec{r}_1,\cdots,\vec{r}_{N_a})$ of the system can be obtained from electronic structure models. As mentioned in the introduction, it is a very computationally expensive procedure, and without too much loss in precision, MD use empirical potentials that are designed for specific purposes.
The MD simulation performed using the GROMACS software package~\cite{berendsen_gromacs_1995}, employing a gromos54a7 type force field obtained via the tool Automated Topology Builder~\cite{stroet_automated_2018}. 
The procedure of the MD simulation in this work is as followed:...
\end{comment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Electronic Structure Calculations} 
Starting from an atomic morphology, a first step in first-principle multiscale model is to determine the single-electronic wave function and the associated energy $\epsilon_l$, which are used to obtain atomic charges, reorganization energy, molecule energy, and coupling elements.

Each electron $l$ in a system with $N_\text{el}$ electrons has a single-electronic wave function $\phi_l (\vec{r})$ and associated energies $\epsilon_l$ determined as solutions to the Kohn--Sham equations~\cite{kohn_self_1965}
%
\begin{equation}
    \left(-\frac{1}{2}\nabla^2_{\vec{r}} + v_\text{ext}(\vec{r}) + v_\text{H}[\rho](\vec{r}) + v_\text{XC}[\rho](\vec{r})\right) \phi_l(\vec{r}) = H^\text{KS} \phi_l(\vec{r}) = \epsilon_l \phi_l (\vec{r}) ,
    \label{eq:KS2}
\end{equation}
%
where $v_\text{ext}$ in an external potential (typically from the nuclei), $v_\text{H}[\rho]$ the electrostatic Hartree potential of a classical charge density $\rho(\vec{r})$, and $v_\text{XC}[\rho]$ the exchange-correlation functional containing explicit quantum-mechanical electron-electron interactions. The charge density is determined from the single-particle wave functions as $\rho(\vec{r})=\sum\limits_{l=1}^{N_\text{el}} \left\vert\phi_l(\vec{r})\right\vert^2$. As the Hartree and exchange-correlation potential depend on the thus defined density, solutions to Eq.~\ref{eq:KS2} have to be found self-consistently. This corresponds to finding the ground-state density $\rho_0$ that minimized the total energy of the system
%
\begin{equation}
    U[\rho] = T_s[\rho] + \int v_\text{ext}(\vec{r}) \rho(\vec{r}) d \vec{r} + E_\text{H}[\rho] + E_\text{XC}[\rho]
    \label{eq:KS_model}
\end{equation}
%
where $T_s[\rho]$ is the kinetic energy, $E_\text{H}[\rho]$ and $E_\text{XC}[\rho]$ the Hartree and exchange-correlation energies, respectively. Equations \ref{eq:KS2} and \ref{eq:KS_model} can be solved for different total charge states $x=\text{n,c}$ and corresponding  equilibrium geometries $X=\text{N,C}$, where $\text{n}$ and $\text{N}$ stand for ''neutral'' and $\text{c}$ and $\text{C}$ for ''charged''. The respective total energies will be denoted in the following as $U^\text{xX}$.

The practical calculations in this work have been performed with the ORCA software~\cite{Neese2012a} using the def2-tzvp~\cite{weigend_accurate_2006} basis set to represent the Kohn--Sham wave functions $\phi_l(\vec{r})$. 
The correlation potential is represented by PBE0 functional, and the exchange potential is represented by a portion $\alpha$ of (HFX) potential and another portion $(1-\alpha)$ from PBE0 functional. In common practice, $\alpha$ is small and below 0.25. For our uncertain quantification study, $\alpha=0,0.05,0.10,0.15,0.20,0.25$ is chosen for the multiscale model.

\subsection{Transition Rate Calculation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Time-of-flight and Steady State Velocity Calculation}
The multiscale model defines a graph $\mathbf{G}$ with an adjacency matrix $\mathbf{W}$, where the nodes represent molecules and the edge weights $\omega_{ij}$ represent the Marcus rate from molecule $i$ to molecule $j$. 
The charge dynamics are modeled as a continuous-time random walk on this graph. In the time-of-flight (ToF) model, some vertices serve as \textit{Source} nodes, representing the electrode where charge carriers are injected, and some as \textit{Sink} nodes, where charge carriers are detected and the ToF is recorded.

In CTRW the ToF is calculated as the expected hitting time of a continuous time Markov chain.

For a system with $N$ molecules and one charge carriers, there are $N$ possible occupation states. A state is called the Source state if one of the Source molecule is occupied, and a Sink state is the one when one of the Sink molecule is occupied.

The transition rates between the states defines the adjacency matrix $\mathbf{W}:\omega_{ij}$.
According to such connectivity between the molecules, the transition rates $\mathbf{W}_{ij}$ from state $i$ to $j$ is:
\begin{equation}\label{eq:transition_rates}
	\mathbf{W}_{ij} =
	\begin{cases}
	     0			&  i \text{ is not connected to } j,\\
         \omega_{ij}   &  i \text{ is connected to } j,
	\end{cases}
\end{equation}

Then the transition probability from state $i$ to $j$ is $p_{ij} = \mathbf{W}_{ij}/D_i$ where $D_i := \sum_{j} \mathbf{W}_{ij}$.
And the expected time from state $i$ to reach the Sink state $\tau_i$ is calculated via: 
\begin{equation}\label{eq:hitting_time}
	\tau_i = \begin{cases}
		\frac{1}{D_i} + \sum_{j \ne i} p_{ij} \tau_{j} &\text{if $i$ is not a sink state},\\
		0 &\text{else.} 
	\end{cases}
\end{equation} 

To account for all possible starting nodes of the carriers, all Source states must be considered. The random walk process can be modeled as a parallel electric network of capacitors \cite{doyle_random_2000}. Accordingly, the ToF is evaluated using the harmonic mean:
\begin{equation} 
\tau = N_\text{source} \left[\sum_{i \in \text{Source}} (\tau_i)^{-1}\right]^{-1},
\label{eq:ToF}
\end{equation}
where $N_\text{source}$ is the number of Source states.

To calculate $v_\text{SS}$ the steady state distribution $\pi_i$ is required. In continuous time Markov chain, the steady state distribution vector $\vec{\pi}: \pi_i$ is the null-space of $\mathbf{W}-\mathbf{D}$:
\begin{equation}
    (\mathbf{W}-\mathbf{D} )\vec{\pi} = \mathbf{0}
\end{equation}
where $\mathbf{D} = \text{diag}(D_i)$ is the out-degree matrix of $\mathbf{W}$.

\begin{equation}
    v_\text{SS} = \sum_i \pi_i \sum_j \omega_{ij} || \vec{r}_{ij}||_2
\end{equation} 
where $\omega_{ij}$ is the charge transition rate from molecule $i$ to molecule $j$, and $\vec{r}_{ij}=\vec{r}_j - \vec{r}_i$ is the center-of-mass (COM) distance vector. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Results on MADN}

In this study, we investigate the hole-transporting organic semiconductor MADN (2-Methyl-9,10-di(naphth-2-yl)anthracene) and study its charge mobility's dependence on HFX. 

Atomic charges and molecule polarizability $P_\text{iso}$ are crucial for evaluating molecular energy contributions from electrostatic and polarization effects. A physical property related to the overall atomic charges is dipole moment at charge neutral state. 


%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.75\textwidth]{figs/fig_autogen.pdf}
    \caption{(a) The dipole moment of neutral state MAND molecule $\mu$, (b) isotropic polarizability $P_\text{iso}$, (c) reorganization energies $\lambda$ and (d) energy disorder $\sigma(E)$ as a function of the HFX parameters (denoted by $\alpha$).}
    \label{fig:autogen_MADN}
\end{figure}
% 

To demonstration the effect of HFX on the atomic charges and molecule polarizability $P_\text{iso}$,
Figure \ref{fig:autogen_MADN}(a)(b) illustrates the dependence of the dipole moment $\mu$ and isotropic polarizability $P_\text{iso}$ on HFX.
Figure \ref{fig:autogen_MADN}(c)(d) show 
The reorganization energy $\lambda$ and energy disorder $\sigma(E)$ as a function of HFX parameter are also shown in Fig .\ref{fig:autogen_MADN}(c)(d).

From Fig. \ref{fig:autogen_MADN}(a) one can notice a mild decrease in the dipole moment with increasing HFX and in Fig. \ref{fig:autogen_MADN}(b) a linear decrease in isotropic polarizability for both neutral and charged MADN states as HFX increases from 0 to 0.25, indicating reduced molecular polarizability.
Figure \ref{fig:autogen_MADN}(c) indicates an increase in reorganization energy $\lambda$ with higher HFX, reflecting greater energy requirements for electronic adjustments during charge transfer. This increase is nonlinear compared to the linear decrease in $P_\text{iso}$.
Figure \ref{fig:autogen_MADN}(d) shows that the energy disorder $\sigma(E)$ for MADN are similar and close to \unit[0.08]{eV} under different HFX values.

To calculate the ToF from the electronic structures, the \textit{Source} region contains molecules with X-coordinate $0 < r^x_i < 0.5$ nm, and the \textit{Sink} region contains molecules with X-coordinate $8.5 < r^x_i < 9$ nm. 

The ToF is also calculated without energy disorder, meaning $\Delta E_{ij}=0$ for all $i,j$.
Table \ref{tab:ToF_MADN_HFX} shows the ToF and corresponding diffusive velocity $v_\text{ToF}$.
With energy disorder, the ToF increases by a factor of approximately 15 as $\alpha$ increases from 0 to 0.25.  
While without energy disorder, the increase factor is about 4. This increase in ToF is attributed to the rise in $\lambda$, changes in molecular energies, and variations in coupling elements.

\begin{table}[H]
    \centering
    \begin{tabular}{c c c c c}
    \hline
        $\alpha$ & ToF [s] & $v_\text{ToF}$ [m/s] & ToF(no $E$) [s] & $v_\text{ToF}$ (no $E$) [m/s] \\
    \hline
        0.00 &  $6.4 \times 10^{-9}$ & 1.2 & $1.9 \times 10^{-10}$ & 42 \\
        0.05 & $ 7.9 \times 10^{-9}$ & 1.0 & $4.1 \times 10^{-10}$ & 20 \\
        0.10 & $ 1.6 \times 10^{-8}$ & 0.51 & $4.0 \times 10^{-10} $ & 20 \\
        0.15 & $ 3.0 \times 10^{-8}$ & 0.31 & $4.0 \times 10^{-10} $ & 25 \\
        0.20 & $ 2.1 \times 10^{-8}$ & 0.39 & $4.5 \times 10^{-10}$ & 18 \\
        0.25 & $ 9.5 \times 10^{-8}$ & 0.083 & $7.2 \times 10^{-10}$ & 11 \\
    \hline
    \end{tabular}
    \caption{The ToF and diffusive velocity calculated by ToF along a distance $L_x = 8$ [nm] with and without energy disorder of the MADN system as a function of the HFX. }
    \label{tab:ToF_MADN_HFX}
\end{table}

Figure \ref{fig:E_qmmm_MADN} presents a scatter plot comparing the site energies of MADN molecules across different HFX values, using $\alpha$ = 0.25 (PBE0 functional) as a reference. The energies consistently fall within the range of -0.5 to -1.1 eV, with data points clustering near the diagonal line, indicating similar molecular energies regardless of HFX variation.
To quantify the similarity between two empirical distribution, Wasserstein distance is used.
Denote the empirical distribution of molecular energy $E$ at $\alpha=0$ to be $P_{E(\alpha=0)}$. 
The 1-Wasserstein distance between $P_{E(\alpha=0)}$ and $P_{E(\alpha=0.25)}$ is calculated as:
\begin{equation}
    W_1 (P_{E(\alpha=0)}, P_{E(\alpha=0.25)}) = (\frac{1}{N} \sum\limits_{i=1}^N | E_{i,\text{order}}(\alpha=0) - E_{i,\text{order}}(\alpha=0.25) |)
\end{equation}
where $E_{i,\text{order}}(\alpha=0)$ is the order statistics of $E_i(\alpha=0)$. The 1-Wasserstein distance between two empirical distributions for each plot in Fig. \ref{fig:E_qmmm_MADN} is shown in Table \ref{tab:W2_E}. $W_1 (P_{E(\alpha=0)}, P_{E(\alpha=0.25)})$ has range between 0.0045 to 0.0091, indicating that such molecule energy on average has difference less than 2\% since the energy has range from -0.5 to -1.1 eV.

\begin{table}[H]
    \centering
    \begin{tabular}{c c c c c c}
    \hline
 $\alpha'$ & 0 & 0.05 & 0.10 & 0.15 & 0.20 \\
    \hline
 $W_1 (P_{E(\alpha')}, P_{E(\alpha=0.25)})$ &  0.0054 & 0.0091 & 0.0067 & 0.0053 & 0.0045 \\
 $W_1 (P_{E^\text{el}(\alpha')}, P_{E^\text{el}(\alpha=0.25)})$ &  0.010 & 0.012 & 0.0089 & 0.0070 & 0.0032 \\
 $W_1 (P_{E^\text{polar}(\alpha')}, P_{E^\text{polar}(\alpha=0.25)})$ &  0.0065 & 0.0043 & 0.0027 & 0.0023 & 0.0031 \\
 $W_1 (P_{\log_{10}(J_{ij}^2)(\alpha')}, P_{\log_{10}(J_{ij}^2)(\alpha=0.25)})$ &  0.0054 & 0.0091 & 0.0067 & 0.0053 & 0.0045 \\
    \hline
    \end{tabular}
    \caption{The 1-Wasserstein distance between the distributions pair of molecule energy $P_{E(\alpha)}$, electrostatic energy $P_{E^\text{el}(\alpha)}$, polar energy $P_{E^\text{polar}(\alpha)}$ and $P_{\log_{10}(J_{ij}^2)(\alpha)}$. }
    \label{tab:W2_E}
\end{table}


\begin{figure}[H]
    \centering
    \includegraphics[width=0.99\textwidth]{figs/scatterE_qmmm.pdf}
    \caption{Scatter plot of site energy of MADN molecules calculated from different HFX, compared to the site energy calculated from HFX=0.25 (The PBE0 functional). The brighter color near the diagonal lines indicates denser population of the molecules.  The top and right histogram show the energy distributions.}
    \label{fig:E_qmmm_MADN}
\end{figure}


Figures \ref{fig:Estat_qmmm_MADN} and \ref{fig:Edip_qmmm_MADN} show that both electrostatic and polarization energies remain consistent close across HFX values from 0 to 0.25, since all the points comparing $E_i(\alpha')$ and $E_i(\alpha=0.25)$ in the scatter plot are close to the diagonal line.
The 1-Wasserstein distance between the distribution of $E^\text{el}$ calculated by $\alpha'$ and that calculated by $\alpha=0.25$, $W_1(P_{E^\text{el}(\alpha')}, P_{E^\text{el}(\alpha=0.25)})$, is shown at Table \ref{tab:W2_E}. It shows that $W_1(P_{E^\text{el}(\alpha')}, P_{E^\text{el}(\alpha=0.25)})$ is at maximum 0.012. The 1-Wasserstein distance between the $E^\text{polar}$ distribution calculated by $\alpha'$ and that calculated by $\alpha=0.25$ is also shown in Table .\ref{tab:W2_E}, with a maximum of 0.006. So the small Wasserstein distances suggest that the using different $\alpha'$ other than $\alpha=0.25$, the data of $E, E^\text{el}, E^\text{polar}$ have not changed significantly.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.99\textwidth]{figs/scatterEstat_qmmm.pdf}
    \caption{Scatter plot of MADN electrostatic energy calculated from different HFX, compared to the electrostatic energy calculated from HFX=0.25 (The PBE0 functional). The brighter color near the diagonal lines indicates denser population of the molecules.  The top and right histogram show the energy distributions.}
    \label{fig:Estat_qmmm_MADN}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.99\textwidth]{figs/scatterEdip_qmmm.pdf}
    \caption{Scatter plot of MADN polarization energy calculated from different HFX, compared to the polarization energy calculated from HFX=0.25 (The PBE0 functional). The brighter color near the diagonal lines indicates denser population of the molecules.  The top and right histogram show the energy distributions.}
    \label{fig:Edip_qmmm_MADN}
\end{figure}

The electrostatic energy ranges from 0.1 to -0.6 eV, while polarization energy spans -0.5 to -0.8 eV.  Similar to the molecule energy, the data points are clustered near the diagonal line. 
The standard deviations of the electrostatic energy are 0.099, 0.094, 0.099, 0.11, 0.10, \unit[0.10]{eV}, and the standard deviations of the polarization energies are 0.044, 0.043, 0.043, 0.047, 0.045, \unit[0.045]{eV}. So the disorder in electrostatic energies is consistently larger than than in molecule energies, and the palorization effect reduces the electrostatic energy disorder. 
Each individual molecule has similar polarization energies under different HFX calculation, in spite of $P_\text{iso}$ is linearly dependent on HFX. 

The coupling element obtained with different HFX for each molecular pair compared to that obtained with HFX=0.25 is shown in the scatter plot Fig. \ref{fig:J_MADN}.
\begin{figure}[H]
    \centering
    \includegraphics[width=0.95\textwidth]{figs/scatterJ_all.pdf}
    \caption{Scatter plot of MADN coupling element $\log_{10} J^2$ calculated from different HFX, compared to the polarization energy calculated from HFX=0.25 (The PBE0 functional). The brighter color near the diagonal lines indicates denser population of the molecules.  The top and right histogram show the energy distributions.}
    \label{fig:J_MADN}
\end{figure}

The distribution of the majority $\log_{10} J^2$ has a range of -14 to -2 while only a few $\log_{10} J^2$ has low value below -15. For all HFX values, the distribution has a peak at around -5. 
For large values $\log_{10} J^2 < -5$ the coupling element calculated from $\alpha'=0, 0.05, 0.10, 0.15, 0.2$ remains consistently close to that calculated by $\alpha=0.25$. While for small values $\log_{10} J^2 > -5$, the $\alpha'$ calculated coupling elements for a specific molecular pair can have large variation compared to $\log_{10} J^2$ calculated using $\alpha=0.25$.

In charge transport network, $J^2$ is undirectional for a molecular pair, and decays exponentially as the mutual center-of-mass distance increases. The large $\log_{10} J^2$ are usually observed for molecular pairs with small center-of-mass distance. 
When the center-of-mass distance is very large, the $\log_{10} J^2$ is small and some of those small $\log_{10} J^2$ are sensitive to $\alpha$. 

However, the charge dynamics is dominated by large $\log_{10} J^2$ which are found between molecule pair having small center-of-mass. As the center-of-mass distance increases, $\log_{10} J^2$ becomes small and negligible for the charge dynamics.

To determine the range of $\log_{10} J^2$ that are significant for the charge dynamics, a percolation algorithm is performed. This algorithm aims to find the largest size of subgraphs after removing the edges whose coupling elements are below a critical value. The procedure is as follows:
\begin{enumerate}
    \item A critical value $J_c$ is chosen,
    \item In graph $\mathbf{G}$ remove all the edges with $J^2 < J_c^2$
    \item Calculate the maximum size $\max({N_\text{sub}})$ of the connected subgraphs
\end{enumerate}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.75\textwidth]{figs/fig_network_all.pdf}
    \caption{The maximum size of the subgraphs obtained in the percolation algorithm as a function of critical value $J_c$. The molecular systems obtained by different HFX are colored according to the legend.}
    \label{fig:J_percolate}
\end{figure}
After performing percolation algorithm, Figure \ref{fig:J_percolate} shows the dependence of $\max({N_\text{sub}})$ on the critical value $J_c$. When $\log_{10} J_c^2 < -4.5$, $\max({N_\text{sub}})$ is 1000, meaning that removing all the edges with $J^2 < 3.1 \times 10^{-5}$ the 1000 vertexes still form a connected graph. 
But when removing the edges with $J^2 < 3.1 \times 10^{-4}$ ( corresponding to $J_c > -3.5$), the maximum size subgraph is 600, and it quickly decreases as $J_c$ increases, showing a phase transition. 
So the dominated coupling elements are those with $\log_{10} J_c^2 > -4.5$. 
And the variation in small $J$ due to HFX has less impact on the charge dynamics. 

In this section we answer the question of how does HF level change the electronic structures and 
how does HF level change the charge mobility. 
In the next section, uncertainty quantification via Monte Carlo method and sensitivity analysis is perform to answer which electronic structure (among energy, coupling element and reorganization energy) uncertainty has the most impact on the charge mobility distribution. 
And further we estimate the range of the quantity of interest, given a confidence level.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{ToF Distribution and Sensitivity Analysis}
The previous section shows that different HFX affect the calculated ToF. In this section, we use the Monte Carlo method to estimate the range of the ToF given a confidence level, followed by a sensitivity analysis to determine which parameter contributes more to the variance of ToF. 

\subsection{ToF Distribution}
The ToF is calculated from electronic structure ($E$, $\lambda$ and $\log_{10}(J^2)$) data, that is, ToF is a function with the input of all electronic structure parameters:
\begin{equation}
    %\tau = g(\lambda, \{E_i|i=1,2,\cdots,N \}, \{J_{ij}|i,j=1,2,\cdots,N \}) \;
    \tau = g(x_1, x_2, \cdots, x_{N_d})
    \label{eq:tau1}
\end{equation}
The input $(x_1, x_2, \cdots, x_{N_d})$ represents the collection of the parameters $$(\lambda, \{E_i|i=1,2,\cdots,N \}, \{J_{ij}|i,j=1,2,\cdots,N \})$$  where $N_d$ is the parameter dimension, that is the number of input parameters. 
And $\{E_i|i=1,2,\cdots,N \}$ is the ordered set whose elements are the molecule energy,
$\{J_{ij}|i,j=1,2,\cdots,N \}$ is the ordered set whose elements are the coupling elements. 

Since the exchange-correlation functional is not known and each molecule has a slightly different structure compared to the optimized structure, each parameter has uncertain. 
To estimate the uncertainty, we consider the maximum amount of uncertainties according to the obtained $(\lambda, \{E_i|i=1,2,\cdots,N \}, \{J_{ij}|i,j=1,2,\cdots,N \})$ with the six different HFX.
To achieve this, each parameter can be modeled as a normal distribution with the mean and standard deviation obtained by the maximum likelihood estimation. For a normal distribution, they are respectively the sample mean and standard deviation obtained by six varying HFXs.

Then Monte Carlo scheme is used to estimate the distribution of the ToF. The Monte Carlo scheme has the procedure:
\begin{enumerate}
\item For all $i,j=1,2,\cdots, N_d$, obtain a realization $(x_1, x_2, \cdots, x_{N_d})$ where each parameter has the normal distribution, meaning the corresponding electronic parameters are sampled from the distribution $\lambda_i \in \mathcal{N}(\mathbb{E}(\lambda), \mathbb{V}(\lambda))$, $E_i \in \mathcal{N}(\mathbb{E}(E_i), \mathbb{V}(E_i))$, $\log_{10}(J_{ij}^2) \in \mathcal{N}(\mathbb{E}(\log_{10}(J_{ij}^2)), \mathbb{V}(\log_{10}(J_{ij}^2)))$. 
\item Calculate ToF using the sampled data set $(x_1, x_2, \cdots, x_{Nd})$. 
\item Repeat step 1 and 2 for $N_\text{MC} = 50000$ times to obtain ToFs. Plot the distribution of the ToFs.
\item Estimate the 99\% confidence interval around the median.
\end{enumerate}

%From equation \ref{eq:hitting_time}, the ToF can be considered as the some combination of occupation time in the molecules, which is $log_{10}(\omega_{i}^{-1})$. 
%When the parameters $E, J_{ij}, \lambda_{ij}$ are normally distributed random variables, the calculated ToF shows that variables $E,\lambda_{ij}$ has a larger influence than $J_{ij}$. 
%The Marcus rate uses $E,\lambda_{ij}$ in the exponential form. If $\Delta E$ is normally distributed, then $log_{10}(\omega_{i}^{-1})$ is Gamma distributed. 
%Since $E$ has greater influence to ToF than $\lambda_{ij}, J_{ij}$ and to be consistent, Gamma distribution is used to fit the Monte Carlo sampled ToF in all the investigated cases.

\begin{comment}
    Sampling the molecule energy as a normal distribution $E_i \sim \mathcal{N}(\bar{E}_i, \sigma_{E_i})$ will potentially destroy the energy correlation, especially for correlated systems, resulting a shift in the ToF calculation.
But we will show that making the molecule energy uncorrelated in the MADN system will not cause such a shift in ToF. 
To do so, let $\{E_1, E_2, \cdots, E_N\}^{\alpha}$ be an ordered set with elements being the energy calculated using a specific $\alpha$ value. 
Then the order of the energies are randomly shuffled so that they are no longer correlated, and denote it as $\{E_1, E_2, \cdots, E_N\}^{\alpha}_{\text{shuffle}}$. The ToF calculated using the shuffled energy is $ \tau_{\text{sh}} = \tau(\{E_1, E_2, \cdots, E_N\}^{\alpha}_{\text{shuffle}}) $.
%
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{figs/ToFx_shuffle.pdf}
    \caption{Distribution of $\tau_{\text{sh}}$ calculated using shuffle energies. Each distribution are a sample of 10000 $\tau_{\text{shuffle}}$. The position of the solid circle indicates the ToF calculated from the specific $\alpha$ value, and the position of the solid square indicates the average $\tau_{\text{shuffle}}$ over the 10000 samples.}
    \label{fig:ToF_shuffle_MADN}
\end{figure}
%
After such shuffling energy and ToF calculation for 10000 times, the distribution of $\tau_{\text{sh}}$ are shown in Fig.\ref{fig:ToF_shuffle_MADN}. 
For the chosen $\alpha=0.05, 0.15, 0.25$, the $\tau_{\text{sh}}$ does not overall shift to smaller or large values, and the averaged $\tau_{\text{sh}}$ is close to the ToF obtained without energy shuffle.
So making the energy uncorrelated will not shift the ToF to smaller or larger values.
This enables representing the parameter uncertainties in $\lambda, \{E_i\}, \{ J_{ij}\}$ by the normal distribution without shift the ToF.
\end{comment}

To understand how the uncertainty pass from $E, \lambda, J_{ij}$ to ToF, the parameter control is used. That is, a set of parameter, such as $E_i$ for all $i=1,2,\cdots,N$ is choose while keeping other parameter fixed, then performed Monte Carlo sampling to obtain ToF distribution and estimate upper and lower confidence bound.
Then we use Sobol total indices to analyze and quantify 
which uncertainty among $E, \lambda, J_{ij}$ has a greater impact on the ToF, 

The distribution that we want to obtained during the parameter control are as followed:
\begin{enumerate}
    \item Fixed the $\lambda$ to be $\mathbb{E}(\lambda)$, and $\log_{10}(J_{ij}^2)$ to be $\mathbb{E}(\log_{10}(J_{ij}^2))$. Then each molecule energy $E_i$ is sampled from the normal distribution $\mathcal{N}(\mathbb{E}(E_i), \mathbb{V}(E_i))$. Finally obtain and plot the histogram $N_\text{MC}$ sample of $\tau$, whose distribution is denoted as $P(\log_{10}(\tau)|E_i \text{ uncertain})$.
    \item Fixed all $E_i$ to be $\mathbb{E}(E_i)$ and all $\log_{10}(J_{ij}^2)$ to be $\mathbb{E}(\log_{10}(J_{ij}^2))$. Then $\lambda$ is sampled from the normal distribution $\mathcal{N}(\mathbb{E}(\lambda), \mathbb{V}(\lambda))$. Finally obtain and plot the histogram  $N_\text{MC}$ sample of $\tau$, whose distribution is denoted as $P(\log_{10}(\tau)|\lambda \text{ uncertain})$. 
    \item Fixed the $\lambda$ to be $\mathbb{E}(\lambda)$ and all $E_i$ to be $\mathbb{E}(E_i)$.     Then $J_{ij}$ is sampled from the normal distribution $\log_{10}(J_{ij}^2) \in \mathcal{N}(\mathbb{E}(\log_{10}(J_{ij}^2)), \mathbb{V}(\log_{10}(J_{ij}^2)))$. Finally obtain and plot the histogram  $N_\text{MC}$ sample of $\tau$, whose distribution is denoted as $P(\log_{10}(\tau)|J_{ij} \text{ uncertain})$.
    \item Both $E_i$, $\lambda$ and $J_{ij}$ are sampled from their normal distribution:$\lambda_i \in \mathcal{N}(\mathbb{E}(\lambda), \mathbb{V}(\lambda))$, $E_i \in \mathcal{N}(\mathbb{E}(E), \mathbb{V}(E))$, $\log_{10}J_{ij}^2 \in \mathcal{N}(\mathbb{E}(\log_{10}J_{ij}^2), \mathbb{V}(\log_{10}J_{ij}^2))$. Then obtain and plot the histogram $N_\text{MC}$ sample of $\tau$, whose distribution is denoted as the following distribution: 
    $P(\log_{10}(\tau)|E_i, \lambda, J_{ij} \text{ uncertain})$.
\end{enumerate}


The ToF distribution for the MADN systems with energy disorder is shown in Fig.\ref{fig:mle_MADN_withE}.
The lower and upper bounds in Fig. \ref{fig:mle_MADN_withE} shows that when only the energies $E_i$ are uncertain, the $\log_{10}(\tau)$ has lower -8.0 and upper bound -6.5. This lower and upper bound is close to that of $P(\log_{10}(\tau)|E_i, \lambda, J_{ij} \text{ uncertain})$, meaning that varying the energy alone generates a $\tau$ distribution close to that when $E_i, \lambda, J_{ij}$ are uncertain. 

Figure .\ref{fig:mle_MADN_withE}(b) shows that $\log_{10}(\tau)$ has a confidence interval of -8.0 to -7.4 when $\lambda$ is varied. 
Figure \ref{fig:mle_MADN_withE}(c) show that when $J_{ij}$ is uncertain $\log_{10}(\tau)$ has a sharp confidence interval of -7.9 to -7.7, suggesting that the variation in $J_{ij}$ leads to relatively small change in $\log_{10}(\tau)$ compared to $E_i$ and $\lambda$.
%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.70\textwidth]{figs/fig_mle_MADN_withE.pdf}
    \caption{Distribution of ToFs in the multiscale modeled MADN system.
    Monte Carlo sampling with a sample size $N_\text{MC}=50000$ is used to obtain the sampled distribution. The red vertical lines indicate the lower bound and upper bound of the 99\% confidence interval around the median.
    The black circles indicate the ToF obtained using varying HFX values.
    (a) $P(\log_{10}(\tau)|E_i \text{ uncertain})$, 
    (b) $P(\log_{10}(\tau)|\lambda \text{ uncertain})$, 
    (c) $P(\log_{10}(\tau)|J_{ij} \text{ uncertain})$, 
    (d) $P(\log_{10}(\tau)|E_i, \lambda, J_{ij} \text{ uncertain})$. }
    \label{fig:mle_MADN_withE}
\end{figure}
%

% The 90\% confidence interval of each distribution and the fitted Gamma distribution is summarized in table 
When the energy disorder in MADN system is not considered, that is, all the MADN molecule energy are set to be equal giving $\Delta E=0$, the distribution of ToF is shown in Fig.\ref{fig:mle_MADN_noE}

Measuring the sensitivity of each electronic parameter to ToF is to measure each electronic parameter's contribution to the variance of ToF. 
That is, if ToF is most sensitive to one parameter, the variance in this particular parameter will contribute most to the ToF variance. 

%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.99\textwidth]{figs/fig_mle_MADN_noE.pdf}
    \caption{Distribution of ToFs in the multiscale modeled MADN system.
    Monte Carlo sampling with a sample size $N_\text{MC}=50000$ is used to obtain the sampled distribution. The red vertical lines indicate the lower bound and upper bound of the 99\% confidence interval around the median.
    Energy disorder is not consider. 
    The black circles indicate the ToF obtained using varying HFX values.
    (a) $P(\log_{10}(\tau)|\lambda \text{ uncertain})$, 
    (b) $P(\log_{10}(\tau)|J_{ij} \text{ uncertain})$, 
    (c) $P(\log_{10}(\tau)|\lambda, J_{ij} \text{ uncertain})$. }
    \label{fig:mle_MADN_noE}
\end{figure}
%


One way of decomposing the variance of the model output into fractions attributed to input parameters is the variance-based sensitivity analysis. The local sensitive analysis is to use the partial derivative $\frac{\partial \tau}{\partial x_i}$. While the global sensitivity analysis can use Sobol's indices. Given a model of Equation \ref{eq:tau1}, to measure the parameter $x_i$'s contribution to $\tau$ including all variance caused by its interaction with other parameters $\{x_k, k \neq i \}$, the total effect Sobol's index is calculated as \cite{saltelli_variance_2010}:
\begin{equation}
    S_{T,i} = \frac{ \mathbb{E}_{\mathbf{x}_{\sim i}}[ \mathbb{V}_{x_i}(\tau|\mathbf{x}_{\sim i}) ] }{ \mathbb{V}(\tau) }
    \label{eq:STi}
\end{equation}
The details of the notation is as followed: the vector $\mathbf{x}=(x_1, x_2, \cdots, x_{N_d})$, and $\mathbf{x}_{\sim i}$ denotes the vector of all entries but $x_i$. 
$\mathbb{V}_{x_i}(\tau|\mathbf{x}_{\sim i})$ means the variance of $\tau$ given a set of $\mathbf{x}_{\sim i}$ taken over $x_i$. And $ \mathbb{E}_{\mathbf{x}_{\sim i}}[\cdot]$ denotes the mean of argument $(\cdot)$ taken over all factors but $x_i$.


Then the $\lambda$ contribution to the total variance is $S_{T,i=1}$.
The energy contribution to the total variance is $S_{T,E} = \sum\limits_{i=1}^{N+1} S_{T,i}$ where $N=1000$ is the number of energy parameter, and the coupling element contribution due to variation in $\log_{10}(J_{ij}^2)$ to the total variance is $S_{T,J}=\sum\limits_{i=N+2}^{N_d} S_{T,i}$. 
Using the quasi Monte Carlo method\cite{sobol_global_2001} with a sample size $N_\text{QMC}=1000$ to calculate $S_{T,i}$, the results are shown in the table \ref{tab:Sobol}.
%
%\begin{table}[H]
%    \centering
%    \begin{tabular}{c c c c }
%        \toprule
%        parameter & $\lambda$ & $E$ & $\log_{10} J^2$   \\
%        \midrule
%        $S_T$ & 0.097 & 0.95 & 0.018\\
%        \bottomrule
%    \end{tabular}
%        \caption{Sobol indices of $\lambda$, $E$ and $\log_{10} J^2$.}
%        \label{tab:Sobol}
%\end{table}
%

\begin{table}[H]
    \caption{Sobol indices of $\lambda$, $E$ and $\log_{10} J^2$ when ToF is calculated with energy disorder, and Sobol indices of $\lambda$ and $\log_{10} J^2$ when ToF is calculated without energy disorder.}\label{tab:Sobol}
    \begin{center}
      \begin{tabular}{c c c c c c c} \hline
        &  \multicolumn{3}{c}{\bf Energy Disorder} & &\multicolumn{2}{c}{\bf no Disorder}\\\cline{2-4}  \cline{6-7}
        parameter  & $\lambda$ & $ E_i$ & $ \log_{10}(J_{ij}^2)$ && $\lambda$ & $ \log_{10}(J_{ij}^2)$ \\ \hline
        %\multicolumn{6}{c}{\bf GRW for $\mathbf{N_c=1}$}\\
     $S_T$  & 0.097 & 0.95 & 0.018 && 0.96 & 0.11 \\
    \hline
      \end{tabular}
    \end{center}
\end{table}

From table \ref{tab:Sobol} one can see that most of the total variance can be attributed to the energy $E$. In contrast to $E$, the uncertainty in $\lambda$ and $\log_{10} J^2$ contributes much less compared to $E$, this is consistent to the Fig.\ref{fig:mle_MADN_withE}, where the distribution in Fig.\ref{fig:mle_MADN_withE}(d) resembles the distribution in Fig.\ref{fig:mle_MADN_withE}(a).
And Fig.\ref{fig:mle_MADN_withE}(c) shows that the uncertainty in $\log_{10}(J^2)$ only leads to small variances.
When there is no energy disorder, the variance in $\lambda$ has the most contribution to the total variance as shown in Table \ref{tab:Sobol}.

\section{Distribution of Steady State Velocity}
The distribution of steady state velocity of MADN is shown as Fig.\ref{fig:mle_MADN_withE_SS} and \ref{fig:mle_MADN_noE_SS}. 
Those distribution shows that the variation in $v_\text{SS}$ distribution is greater than ToF distribution. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{figs/fig_mle_MADN_withE_SS.pdf}
    \caption{Distribution of steady state velocity $v_\text{SS}$ in the multiscale modeled MADN.
    Monte Carlo sampling with a sample size $N_\text{MC}=50000$ is used to obtain the sampled distribution.
    The red vertical lines indicate the lower bound and upper bound of the 99\% confidence interval around the median.
    The black circles indicate the $v_\text{SS}$ obtained using varying HFX values.
    (a) $P(\log_{10}(v_\text{SS})|E_i \text{ uncertain})$, 
    (b) $P(\log_{10}(v_\text{SS})|\lambda \text{ uncertain})$, 
    (c) $P(\log_{10}(v_\text{SS})|J_{ij} \text{ uncertain})$, 
    (d) $P(\log_{10}(v_\text{SS})|E_i, \lambda, J_{ij} \text{ uncertain})$. }
    \label{fig:mle_MADN_withE_SS}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.90\textwidth]{figs/fig_mle_MADN_noE_SS.pdf}
    \caption{Distribution of steady state velocity $v_\text{SS}$ in the multiscale modeled MADN. All molecule energies are set to be zero.  
    Monte Carlo sampling with a sample size $N_\text{MC}=50000$ is used to obtain the sampled distribution.
    The red vertical lines indicate the lower bound and upper bound of the 99\% confidence interval around the median.
    The black circles indicate the $v_\text{SS}$ obtained using varying HFX values.
    (a) $P(\log_{10}(v_\text{SS})|\lambda \text{ uncertain})$, 
    (b) $P(\log_{10}(v_\text{SS})|J_{ij} \text{ uncertain})$, 
    (c) $P(\log_{10}(v_\text{SS})|\lambda, J_{ij} \text{ uncertain})$.  }
    \label{fig:mle_MADN_noE_SS}
\end{figure}

\section{Charge mobility and PF Behavior}
In this section, we want to study the dependence of drift mobility on the HFX. The charge mobility is calculated as:
\begin{equation}
    \mu = \frac{\vec{v} \vec{F} }{ |\vec{F}|^2}
    \label{eq:mu}
\end{equation}
To consider the charge dynamics along X, Y and Z axis in the ToF setting, the ToF is calculated with different settings of \textit{Source}-\textit{Sink} and $\vec{F}$ combinations.

\begin{itemize}
    \item Setting the molecules with $r^x < \min(r^x)+0.5$ as \textit{Source}, and the molecules with $r^x > \max(r^x)-0.5$ as \textit{Sink}, and $\vec{F}^T = (F,0,0)$, denote the calculated the ToF as $\tau_\text{Xmin}$, and the mobility is as $\mu_\text{Xmin} = \frac{L_x }{\tau_\text{Xmin} |\vec{F}|}$.  
    \item Setting the molecules with $r^x > \max(r^x)-0.5$ as \textit{Source}, and the molecules with $r^x < \min(r^x)+0.5$ as \textit{Sink}, and $\vec{F}^T = (-F,0,0)$, denote the calculated the ToF as $\tau_\text{Xmax}$, and the mobility is as $\mu_\text{Xmax} = \frac{L_x }{\tau_\text{Xmax} |\vec{F}|}$.  
    \item Setting the molecules with $r^y < \min(r^y)+0.5$ as \textit{Source}, and the molecules with $r^y > \max(r^y)-0.5$ as \textit{Sink}, and $\vec{F}^T = (0,F,0)$, denote the calculated the ToF as $\tau_\text{Ymin}$, and the mobility is as $\mu_\text{Ymin} = \frac{L_y }{\tau_\text{Ymin} |\vec{F}|}$. 
    \item Setting the molecules with $r^y > \max(r^y)-0.5$ as \textit{Source}, and the molecules with $r^y > \max(r^y)-0.5$ as \textit{Sink}, and $\vec{F}^T = (0,-F,0)$, denote the calculated the ToF as $\tau_\text{Ymax}$, and the mobility is as $\mu_\text{Ymax} = \frac{L_y }{\tau_\text{Ymax} |\vec{F}|}$. 
    \item Setting the molecules with $r^z < \min(r^z)+0.5$ as \textit{Source}, and the molecules with $r^z > \max(r^z)-0.5$ as \textit{Sink}, and $\vec{F}^T = (0,0,F)$, denote the calculated the ToF as $\tau_\text{Zmin}$, and the mobility is as $\mu_\text{Zmin} = \frac{L_z }{\tau_\text{Zmin} |\vec{F}|}$. 
    \item Setting the molecules with $r^z > \max(r^z)-0.5$ as \textit{Source}, and the molecules with $r^z > \min(r^z)+0.5$ as \textit{Sink}, and $\vec{F}^T = (0,0,-F)$, denote the calculated the ToF as $\tau_\text{Zmax}$, and the mobility is as $\mu_\text{Zmax} = \frac{L_z }{\tau_\text{Zmax} |\vec{F}|}$. 
\end{itemize}
Finally the ToF drift mobility is calculated as:
\begin{equation}
    \mu_\text{PF} = \frac{1}{6} (\mu_\text{Xmin}+\mu_\text{Xmax}+\mu_\text{Ymin}+\mu_\text{Ymax}+\mu_\text{Zmin}+\mu_\text{Zmax})
\end{equation}

When the $\lambda, E_i, J_{ij}$ are uncertain and sampled from the normal distribution, the distributions of charge mobility obtained from MC sample under specific electric field are shown in Fig.\ref{fig:fig_mle_withE_mu2_ave}.
%
\begin{figure}[H]
    \centering
    \includegraphics[width=1.05\textwidth]{figs/fig_mle_withE_mu2_ave.pdf}
    \caption{Distribution of $\mu_\text{PF}$ in the multiscale modeled MADN system.
    Monte Carlo sampling with a sample size $N_\text{MC}=10000$ is used to obtain the sampled distribution. The red vertical lines indicate the lower bound and upper bound of the 99\% confidence interval around the median.}
    \label{fig:fig_mle_withE_mu2_ave}
\end{figure}
%

The ToF depends on the electric field through the Marcus rate. 
Poole and Frenkel predicted the electric-field dependence of charge mobility as $\mu_\text{PF}(F)=\mu_0 \exp (\beta \sqrt{|\vec{F}|})$.
So it is common to plot the mobility $\mu_\text{PF}$ against $\sqrt{|\vec{F}|}$ in a so-called Pooleâ€“Frenkel plot.
which is shown in Fig. \ref{fig:PF_plot_ave} for specifie HFX values. The 99\% confidence interval obtained via MC sampled in shown in the green shadow. 
%
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figs/fig_PF_plot_ave.pdf}
    \caption{Electric-field dependence of the mobility $\mu$ in the multiscale modeled MADN system. The dash lines are Pooleâ€“Frenkel plots obtained with specific HFX value, and the green shadow indicates the 99\% confidence interval estimated from the MC sampling with a sample size of $N_\text{MC}=10000$.}
    \label{fig:PF_plot_ave}
\end{figure}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\bibliographystyle{unsrt}
\bibliography{references}


\end{document}